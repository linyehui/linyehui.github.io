<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"linyehui.me","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="HABIT IS POWER">
<meta property="og:type" content="website">
<meta property="og:title" content="HABIT IS POWER">
<meta property="og:url" content="http://linyehui.me/page/9/index.html">
<meta property="og:site_name" content="HABIT IS POWER">
<meta property="og:description" content="HABIT IS POWER">
<meta property="og:locale">
<meta property="article:author" content="linyehui">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://linyehui.me/page/9/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>HABIT IS POWER</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">HABIT IS POWER</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">习惯就是力量</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2013/2013-06-02-a-message-to-garcia/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2013/2013-06-02-a-message-to-garcia/" class="post-title-link" itemprop="url">致加西亚的信</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>文明，就是孜孜不倦地寻找这种人才的一段长久过程</p>
</blockquote>
<p>上周四的凌晨，我听完冬吴相对论，节目中提到了一本书，叫《不说，就真来不及了》，于是我习惯的打开豆瓣看看别人写的书评，有好有坏，我便决定马上买一本。  </p>
<p>拿起iPad对比了下电子书和纸质书的价格，我最后决定在JD上买纸质书，点完购买，网站推荐了几本特价的书，其中有本就是我今天的主题：《致加西亚的信》，￥7.60。</p>
<p>《致加西亚的信》，这是一篇影响我人生成长的文章。</p>
<p>快车组，是我在大学时加入的最好的学生团体，他给我的人生烙上了一种特别的生活态度，而《致加西亚的信》就是快车组生活态度的第一课。  </p>
<p>当时我们一群“新兵”人手一份《致加西亚的信》，一起学习这篇文章，学习的方法是：每个人按顺序大声朗读文章的一个段落，有任何错漏，就必须从头开始重新朗读，读到文章结束，下一位同学就从开头继续往下读，直至整个团队都完成任务。  </p>
<p>当时还是比较单纯，没有想过要吐槽自己真傻或者什么的，只是怀着一股敬意完成了这样的“仪式”。</p>
<p>在“仪式”之后我再也没有重读过那篇文章，直到工作6年之后的今天——花了不到一个小时看完这本小册子，我的豆瓣书评是这样的：  </p>
<blockquote>
<p>我给6页的文章打五星，书中其他部分，剩下的99%，我打-1星。</p>
</blockquote>
<p>短短6页的文章依然能给我带来感动，像是看完日本小学生三十人三十一脚比赛后的那种感觉，感谢快车组。</p>
<p>一百个读者就有一百个哈姆雷特，评价书或者文章的好坏并不是看书的内容是否正确，而在于书对于你能引发多大的思考，这才是书中自有黄金屋的真谛所在。</p>
<p>说回《致加西亚的信》，如果你问我文章中让我感受到的罗文最重要的特质是什么？  </p>
<p>我还真说不上来，但有一个粗俗的词可以概括：靠谱。  </p>
<p>可“靠谱”又是什么样的一个特质呢？“道可道，非常道”，我无法进行完整的阐述，只能“有损”的来理解，并尝试表达如下：</p>
<blockquote>
<p>主动，反馈</p>
</blockquote>
<p>这是一个闭环；  </p>
<p>而我并没有提及能力、性格等等属性，因为在我看来这些属性只是“果”，而不是“因”。</p>
<p>人生的成功就是要找到一群能把信带给加西亚的人，他们会从不同的方面带给你不一样的成功，你找到了吗？</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2013/2013-07-04-new-or-updated-in-windows-8-1-preview/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2013/2013-07-04-new-or-updated-in-windows-8-1-preview/" class="post-title-link" itemprop="url">New or updated in Windows 8.1 Preview</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>上周的Build 2013上微软发布了Windows 8.1 Preview，微软对外公布了8.1的更新信息：  </p>
<p><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/zh-cn/library/windows/apps/bg182889.aspx">New or updated in Windows 8.1 Preview</a></p>
<p>我自己看了之后比较感兴趣的点有下面这些：</p>
<h1 id="1-General-updates"><a href="#1-General-updates" class="headerlink" title="1. General updates"></a>1. General updates</h1><h3 id="App-bundle-support"><a href="#App-bundle-support" class="headerlink" title="App bundle support"></a>App bundle support</h3><p>资源包，方便做多语言的支持，比现在散落在目录下规范很多</p>
<h1 id="2-Diagnostics"><a href="#2-Diagnostics" class="headerlink" title="2. Diagnostics"></a>2. Diagnostics</h1><h3 id="Mixed-language-debugging"><a href="#Mixed-language-debugging" class="headerlink" title="Mixed-language debugging"></a>Mixed-language debugging</h3><p>终于可以同时调试Javascript和C++了，只能说现在的版本太搓了 </p>
<h3 id="Managed-app-debugging"><a href="#Managed-app-debugging" class="headerlink" title="Managed app debugging"></a>Managed app debugging</h3><p>动态修改变量的值，实用功能</p>
<h3 id="Asynchronous-debugging-improvements"><a href="#Asynchronous-debugging-improvements" class="headerlink" title="Asynchronous debugging improvements"></a>Asynchronous debugging improvements</h3><p>task任务的堆栈可以追溯到创建的地方，这个调试异步任务时非常实用</p>
<h3 id="DOM-Explorer"><a href="#DOM-Explorer" class="headerlink" title="DOM Explorer"></a>DOM Explorer</h3><p>得到了加强</p>
<h3 id="JavaScript-Console"><a href="#JavaScript-Console" class="headerlink" title="JavaScript Console"></a>JavaScript Console</h3><p>不用自己console.dir了</p>
<h3 id="JavaScript-Memory-Profiler"><a href="#JavaScript-Memory-Profiler" class="headerlink" title="JavaScript Memory Profiler"></a>JavaScript Memory Profiler</h3><p>现在的发现点还不够智能，需要验证下好不好用才知道</p>
<h3 id="JavaScript-UI-Responsiveness"><a href="#JavaScript-UI-Responsiveness" class="headerlink" title="JavaScript UI Responsiveness"></a>JavaScript UI Responsiveness</h3><p>实用</p>
<h1 id="3-JavaScript-editor"><a href="#3-JavaScript-editor" class="headerlink" title="3. JavaScript editor"></a>3. JavaScript editor</h1><p>小改动都比较实用</p>
<h1 id="4-C-development"><a href="#4-C-development" class="headerlink" title="4. C++ development"></a>4. C++ development</h1><h3 id="C-REST-SDK"><a href="#C-REST-SDK" class="headerlink" title="C++ REST SDK"></a>C++ REST SDK</h3><p>我们自己用不到，但是这也算是当下必备的基础库了</p>
<h3 id="IDE-productivity-features"><a href="#IDE-productivity-features" class="headerlink" title="IDE productivity features"></a>IDE productivity features</h3><p>优化了编译速度，这个比较期待</p>
<h3 id="Build-time-performance-enhancements"><a href="#Build-time-performance-enhancements" class="headerlink" title="Build-time performance enhancements"></a>Build-time performance enhancements</h3><p>优化了并行编译，期待</p>
<h1 id="5-HTML-design-tools"><a href="#5-HTML-design-tools" class="headerlink" title="5. HTML design tools"></a>5. HTML design tools</h1><p>使用的优化，对开发影响不大</p>
<h1 id="6-XAML-design-tools"><a href="#6-XAML-design-tools" class="headerlink" title="6. XAML design tools"></a>6. XAML design tools</h1><p>使用的优化，对开发影响不大</p>
<h1 id="7-Windows-App-Certification-Kit-3-0"><a href="#7-Windows-App-Certification-Kit-3-0" class="headerlink" title="7. Windows App Certification Kit 3.0"></a>7. Windows App Certification Kit 3.0</h1><p>连这个小工具都做了并行优化，挺用心的嘛</p>
<h3 id="New-validation-tests"><a href="#New-validation-tests" class="headerlink" title="New validation tests"></a>New validation tests</h3><h5 id="File-extensions-and-protocols"><a href="#File-extensions-and-protocols" class="headerlink" title="File extensions and protocols"></a>File extensions and protocols</h5><p>数量在规则上并没有什么变化，只是加了检查，网盘类应用应该比较关心这个</p>
<h5 id="JavaScript-background-tasks"><a href="#JavaScript-background-tasks" class="headerlink" title="JavaScript background tasks"></a>JavaScript background tasks</h5><p>考虑省电的缘故，后台不给常驻了，但如果应用配合服务端的话，“常驻”比较难被检查出来吧？不知道微软是怎么检查的</p>
<h3 id="Test-reports"><a href="#Test-reports" class="headerlink" title="Test reports"></a>Test reports</h3><p>之前遇到过一个莫名其妙的启动性能Failed，给的report detail根本就看不出是什么原因导致的，希望这个版本能够有所改进。</p>
<h1 id="8-开发建议"><a href="#8-开发建议" class="headerlink" title="8. 开发建议"></a>8. 开发建议</h1><p>从之前微软发布Windows 8 预览版的节操来看，Preview版本和RTM版本还是会有比较大的差异，所以开发者不要着急着全面跟进8.1的新特性；<br>先把这些特性都研究下，改改兼容性的Bug，能做到8.1正式发布后第一时间有新版本跟进也就可以了。</p>
<p>Good luck， have fun :)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2013/2013-09-25-use-duiengine-with-wtl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2013/2013-09-25-use-duiengine-with-wtl/" class="post-title-link" itemprop="url">在WTL向导工程中使用DuiEngine</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>假设你清楚的理解什么是<a target="_blank" rel="noopener" href="http://wtl.sf.net/">WTL</a>，什么是<a target="_blank" rel="noopener" href="http://duiengine.googlecode.com/">DuiEngine</a>，那么请继续往下看 :)</p>
<h1 id="在WTL向导生成的工程中使用DuiEngine"><a href="#在WTL向导生成的工程中使用DuiEngine" class="headerlink" title="在WTL向导生成的工程中使用DuiEngine"></a>在WTL向导生成的工程中使用DuiEngine</h1><h4 id="1-用WTL向导生成一个Module-Dialog的工程：WTLDemo"><a href="#1-用WTL向导生成一个Module-Dialog的工程：WTLDemo" class="headerlink" title="1. 用WTL向导生成一个Module Dialog的工程：WTLDemo"></a>1. 用WTL向导生成一个Module Dialog的工程：WTLDemo</h4><h4 id="2-用DuiEngine向导生成一个最简单的工程：DuiDemo"><a href="#2-用DuiEngine向导生成一个最简单的工程：DuiDemo" class="headerlink" title="2. 用DuiEngine向导生成一个最简单的工程：DuiDemo"></a>2. 用DuiEngine向导生成一个最简单的工程：DuiDemo</h4><h4 id="3-从DuiDemo目录下复制这些目录和文件到WTLDemo目录下"><a href="#3-从DuiDemo目录下复制这些目录和文件到WTLDemo目录下" class="headerlink" title="3. 从DuiDemo目录下复制这些目录和文件到WTLDemo目录下"></a>3. 从DuiDemo目录下复制这些目录和文件到WTLDemo目录下</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">duires目录</span><br><span class="line">skin目录</span><br><span class="line">MainDlg.h和MainDlg.cpp</span><br><span class="line">UIHandler.h和UIHandler.cpp</span><br></pre></td></tr></table></figure>

<h4 id="4-修改-rc文件，最方便的使用BeyondCompare等工具直接比较合并，其实需要合并过来的就是这三段"><a href="#4-修改-rc文件，最方便的使用BeyondCompare等工具直接比较合并，其实需要合并过来的就是这三段" class="headerlink" title="4. 修改.rc文件，最方便的使用BeyondCompare等工具直接比较合并，其实需要合并过来的就是这三段"></a>4. 修改.rc文件，最方便的使用BeyondCompare等工具直接比较合并，其实需要合并过来的就是这三段</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">3</span> TEXTINCLUDE </span><br><span class="line">BEGIN</span><br><span class="line">    <span class="string">&quot;#if !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)\r\n&quot;</span></span><br><span class="line">    <span class="string">&quot;LANGUAGE 4, 2\r\n&quot;</span></span><br><span class="line">    <span class="string">&quot;#pragma code_page(936)\r\n&quot;</span></span><br><span class="line">    <span class="string">&quot;#include &quot;</span><span class="string">&quot;duires\\winres.rc2&quot;</span><span class="string">&quot; //DUI×ÊÔ´\r\n&quot;</span></span><br><span class="line">    <span class="string">&quot;#endi\0&quot;</span></span><br><span class="line">END</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// XML2</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line">IDR_NAME2ID             XML2                    <span class="string">&quot;duires\\name2id.xml&quot;</span></span><br><span class="line">	</span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Icon</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// Icon with lowest ID value placed first to ensure application icon</span></span><br><span class="line"><span class="comment">// remains consistent on all systems.</span></span><br><span class="line">IDI_MAINWND             ICON                    <span class="string">&quot;duires\\WTLDemo.ico&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> APSTUDIO_INVOKED</span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="comment">// Generated from the TEXTINCLUDE 3 resource.</span></span><br><span class="line"><span class="comment">//</span></span><br><span class="line"><span class="meta">#<span class="keyword">if</span> !defined(AFX_RESOURCE_DLL) || defined(AFX_TARG_CHS)</span></span><br><span class="line">LANGUAGE <span class="number">4</span>, <span class="number">2</span></span><br><span class="line"><span class="meta">#<span class="keyword">pragma</span> code_page(936)</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;duires\winres.rc2&quot;</span> <span class="comment">//DUI×ÊÔ´</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"><span class="comment">/////////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span>    <span class="comment">// not APSTUDIO_INVOKED</span></span></span><br></pre></td></tr></table></figure>

<p>** resource.h中新增两行 **</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#define IDR_NAME2ID                     112</span><br><span class="line">#define IDI_MAINWND                     113</span><br></pre></td></tr></table></figure>

<p>** stdafx.h中加入duiengine的头文件和lib **</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// dui include</span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;duistd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;duihostwnd.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;duictrls.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;duiwndnotify.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;DuiCSS.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;resource.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;duires/res.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">using</span> <span class="keyword">namespace</span> DuiEngine;</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> DLL_DUI</span></span><br><span class="line">	<span class="meta"># <span class="keyword">pragma</span> comment(lib, <span class="string">&quot;duiengine.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">	<span class="meta"># <span class="keyword">pragma</span> comment(lib, <span class="string">&quot;duiengine_static.lib&quot;</span>)</span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure>


<ul>
<li>5.WTLDemo.cpp中新增DuiEngine的初始化和销毁，以及调用逻辑，直接贴下代码</li>
</ul>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;stdafx.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;resource.h&quot;</span></span></span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;MainDlg.h&quot;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DuiSystem.h&quot;</span> </span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&quot;DuiDefaultLogger.h&quot;</span></span></span><br><span class="line"></span><br><span class="line">CAppModule _Module;</span><br><span class="line"></span><br><span class="line"><span class="comment">//////////////////////////////////////////////////////////////////////////</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">RunUI</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="type">int</span> nRet = <span class="number">0</span>;</span><br><span class="line">	CMainDlg dlgMain;</span><br><span class="line">	nRet = dlgMain.<span class="built_in">DoModal</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> nRet;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">RunDuiEngine</span><span class="params">(HRESULT hRes, HINSTANCE hInstance)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="built_in">DUIASSERT</span>(<span class="built_in">SUCCEEDED</span>(hRes));</span><br><span class="line"></span><br><span class="line">	TCHAR szCurrentDir[MAX_PATH + <span class="number">1</span>] = &#123;<span class="number">0</span>&#125;;</span><br><span class="line">	<span class="built_in">memset</span>( szCurrentDir, <span class="number">0</span>, <span class="built_in">sizeof</span>(szCurrentDir) );</span><br><span class="line">	<span class="built_in">GetModuleFileName</span>( <span class="literal">NULL</span>, szCurrentDir, MAX_PATH );</span><br><span class="line">	LPTSTR lpInsertPos = _tcsrchr( szCurrentDir, _T(<span class="string">&#x27;\\&#x27;</span>) );</span><br><span class="line">	*lpInsertPos = _T(<span class="string">&#x27;\0&#x27;</span>);   </span><br><span class="line"></span><br><span class="line">	<span class="function">DuiSystem <span class="title">duiSystem</span><span class="params">(hInstance)</span></span>;</span><br><span class="line"></span><br><span class="line">	DefaultLogger loger;</span><br><span class="line">	loger.<span class="built_in">setLogFilename</span>(<span class="built_in">CDuiStringT</span>(szCurrentDir) + _T(<span class="string">&quot;\\duiengine.log&quot;</span>));</span><br><span class="line">	duiSystem.<span class="built_in">SetLogger</span>(&amp;loger);</span><br><span class="line">	duiSystem.<span class="built_in">logEvent</span>(_T(<span class="string">&quot;demo started&quot;</span>));</span><br><span class="line"></span><br><span class="line">	<span class="comment">// 加载ID名称对照表,该资源属于APP级别，所有皮肤应该共享该名字表，名字表总是从程序资源加载</span></span><br><span class="line">	duiSystem.<span class="built_in">InitName2ID</span>(IDR_NAME2ID,_T(<span class="string">&quot;XML2&quot;</span>));</span><br><span class="line"></span><br><span class="line"><span class="meta">#<span class="keyword">ifdef</span> __DUIFILE_RC </span></span><br><span class="line">	<span class="comment">//从文件夹加载皮肤,指定皮肤位置</span></span><br><span class="line">	_tcscat( szCurrentDir, _T(<span class="string">&quot;\\..\\..\\..\\..\\coding\\demo\\WTLDemo\\skin&quot;</span>) );</span><br><span class="line">	DuiResProviderFiles *pResFiles=<span class="keyword">new</span> DuiResProviderFiles;</span><br><span class="line">	<span class="keyword">if</span>(!pResFiles-&gt;<span class="built_in">Init</span>(szCurrentDir))</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">DUIASSERT</span>(<span class="number">0</span>);</span><br><span class="line">		<span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">	&#125;</span><br><span class="line">	duiSystem.<span class="built_in">SetResProvider</span>(pResFiles);</span><br><span class="line"><span class="meta">#<span class="keyword">else</span> </span></span><br><span class="line">	<span class="comment">//从资源加载皮肤</span></span><br><span class="line">	duiSystem.<span class="built_in">SetResProvider</span>(<span class="keyword">new</span> <span class="built_in">DuiResProviderPE</span>(hInstance));</span><br><span class="line"><span class="meta">#<span class="keyword">endif</span> </span></span><br><span class="line">	</span><br><span class="line">	<span class="comment">//初始化DUI系统,原来的系统初始化方式依然可以使用。</span></span><br><span class="line">	BOOL result = duiSystem.<span class="built_in">Init</span>(IDR_DUI_INIT);</span><br><span class="line">	duiSystem.<span class="built_in">SetMsgBoxTemplate</span>(IDR_DUI_MSGBOX);</span><br><span class="line">	</span><br><span class="line">	<span class="type">int</span> uiResult = <span class="number">0</span>;</span><br><span class="line">	<span class="keyword">if</span> (result)</span><br><span class="line">	&#123;</span><br><span class="line">		uiResult = <span class="built_in">RunUI</span>();</span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	duiSystem.<span class="built_in">logEvent</span>(_T(<span class="string">&quot;demo end&quot;</span>));</span><br><span class="line">	<span class="keyword">delete</span> duiSystem.<span class="built_in">GetResProvider</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> uiResult;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> WINAPI _tWinMain(HINSTANCE hInstance, HINSTANCE <span class="comment">/*hPrevInstance*/</span>, LPTSTR <span class="comment">/*lpstrCmdLine*/</span>, <span class="type">int</span> <span class="comment">/*nCmdShow*/</span>)</span><br><span class="line">&#123;</span><br><span class="line">	HRESULT hRes = ::<span class="built_in">CoInitialize</span>(<span class="literal">NULL</span>);</span><br><span class="line"><span class="comment">// If you are running on NT 4.0 or higher you can use the following call instead to </span></span><br><span class="line"><span class="comment">// make the EXE free threaded. This means that calls come in on a random RPC thread.</span></span><br><span class="line"><span class="comment">//	HRESULT hRes = ::CoInitializeEx(NULL, COINIT_MULTITHREADED);</span></span><br><span class="line">	<span class="built_in">ATLASSERT</span>(<span class="built_in">SUCCEEDED</span>(hRes));</span><br><span class="line"></span><br><span class="line">	<span class="comment">// this resolves ATL window thunking problem when Microsoft Layer for Unicode (MSLU) is used</span></span><br><span class="line">	::<span class="built_in">DefWindowProc</span>(<span class="literal">NULL</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0L</span>);</span><br><span class="line"></span><br><span class="line">	<span class="built_in">AtlInitCommonControls</span>(ICC_BAR_CLASSES);	<span class="comment">// add flags to support other controls</span></span><br><span class="line"></span><br><span class="line">	hRes = _Module.<span class="built_in">Init</span>(<span class="literal">NULL</span>, hInstance);</span><br><span class="line">	<span class="built_in">ATLASSERT</span>(<span class="built_in">SUCCEEDED</span>(hRes));</span><br><span class="line"></span><br><span class="line">	<span class="built_in">AtlAxWinInit</span>();</span><br><span class="line"></span><br><span class="line">	<span class="type">int</span> nRet = <span class="built_in">RunDuiEngine</span>(hRes, hInstance);</span><br><span class="line"></span><br><span class="line">	_Module.<span class="built_in">Term</span>();</span><br><span class="line">	::<span class="built_in">CoUninitialize</span>();</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> nRet;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>6.配置Pre Build Event，直接从DuiDemo复制过来就可以了，就是调用下residbuilder</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2013/2013-09-26-update-duiengine/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2013/2013-09-26-update-duiengine/" class="post-title-link" itemprop="url">升级DuiEngine到2013</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在我开始接触之前，有个很早的项目，使用的是DuiEngine一开始的开源代码，具体时间和版本已经找不清楚了，然后呢现在我需要把他升级到最新版本的<a target="_blank" rel="noopener" href="http://duiengine.googlecode.com/">DuiEngine</a>，在从老的库升级到新版本时遇到了下面这些问题。</p>
<h3 id="DuiEngine版本"><a href="#DuiEngine版本" class="headerlink" title="DuiEngine版本"></a>DuiEngine版本</h3><pre><code>http://duiengine.googlecode.com/svn/trunk
Revision: 246
Author: setoutsoft@qq.com
Date: 2013年8月26日,星期一 14:23:51
Message:
修改窗口默认属性的实现，删除原来的baseClass
</code></pre>
<h3 id="升级过程中遇到的问题及解决方案"><a href="#升级过程中遇到的问题及解决方案" class="headerlink" title="升级过程中遇到的问题及解决方案"></a>升级过程中遇到的问题及解决方案</h3><h4 id="1-skin-xml描述类的变化"><a href="#1-skin-xml描述类的变化" class="headerlink" title="1.skin xml描述类的变化"></a>1.skin xml描述类的变化</h4><p>1.1 原来winres.h中的资源ID是手动一个个添加的，新版本的DuiEngine已经可以用工具自动生成  </p>
<p>解决方案：  </p>
<p>删除之前生成的winrex.h和name2id.xml，用命令行重新生成，其实就是给每个资源在xml中添加一个name属性，体力活，耐心改下，有个简单的方案是把你之前在winres.h中定义的ID作为xml中的name属性，比如：IDC_TXT_TITLE</p>
<blockquote>
<p>..\3rdparty\duiengine\tool\residbuilder -y -p skin -i skin\index.xml -r .\duires\winres.rc2 -n .\duires\name2id.xml -h .\duires\winres.h </p>
</blockquote>
<p>1.2 模板生成的索引xml文件名字从idmap.xml改成了index.xml，这个只是名字的区别，DuiEngine的Demo目录结构还是老的，没有影响</p>
<p>1.3 resid type&#x3D;”PNG”被resid type&#x3D;”IMGX”替代，直接查找替换即可</p>
<p>1.4 header&#x3D;“1”属性被去掉了，改成新的标签了，具体使用方法可以在DuiEngine Demo中搜索<caption><br>解决方案：删除header&#x3D;”1”属性，改成用<caption></caption></p>
<p>1.5 如果对应的xml文件是布局类型的xml，那么记得在index.xml中加个属性layer&#x3D;”1”</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;resid type=&quot;XML&quot;  id_name=&quot;IDR_MAIN_DIALOG&quot; id=&quot;103&quot; layer=&quot;1&quot; file=&quot;xml\dlg_main.xml&quot;  /&gt;</span><br></pre></td></tr></table></figure>

<p>1.6 duiedit改名成了edit，需要在xml添加几个配置，照着Demo工程COPY就好了</p>
<p>1.7 imgframe替换了原来的imghorzex,png等skin类型</p>
<h4 id="2-编译中对ATL的依赖"><a href="#2-编译中对ATL的依赖" class="headerlink" title="2.编译中对ATL的依赖"></a>2.编译中对ATL的依赖</h4><p>我个人比较喜欢WTL，但是新版本中用WTL.mini进行了替换，好在可以用USING_ATL预编译宏进行开关选择继续使用WTL，使用的时候DuiEngine和使用的工程都需要使用这个预编译宏，否则会出现link error</p>
<h4 id="3-static-lib-releaes编译时的诡异link-error"><a href="#3-static-lib-releaes编译时的诡异link-error" class="headerlink" title="3.static lib releaes编译时的诡异link error"></a>3.static lib releaes编译时的诡异link error</h4><p>最后我发现了问题的所在，是一个编译选项配错了，改成默认的就可以了  </p>
<p>C&#x2F;C++-&gt;Language-&gt;Treat wchar_t as Built-in Type  </p>
<p>改成默认的Yes就可以link成功，编译通过了，我不知道是不是我自己不小心改出来的，不过好像google code取下来的代码就是有这个问题的</p>
<h3 id="小结"><a href="#小结" class="headerlink" title="小结"></a>小结</h3><p>昨天下午开始做这个事情，工程我已经迁移完成了，改动的过程比较痛苦，但DuiEngine整个UI库的设计理念没有太大的变化，所以都是些细节，作者也比较懒，没有一个升级的指引，源代码就是文档 :(  </p>
<p>新版本还是改了很多Bug的，我比较奇怪的是作者为什么要把WTL给去掉呢？自己实现的SimpleWnd功能还不全，合并呢？  </p>
<p>我本来可以沿用老版本的DuiEngine，但是本着开源代码就是要用最新的原则，我还是进行了版本升级，过程比现象中的要纠结，但时间比想象中花的少。  </p>
<p>Thanks DuiEngine, gl hf :)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2013/2013-11-15-webbrowser-cross-domain-access/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2013/2013-11-15-webbrowser-cross-domain-access/" class="post-title-link" itemprop="url">WebBrowser内嵌页面的跨域调用问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>很早之前我写过一篇Blog：<a target="_blank" rel="noopener" href="http://blog.csdn.net/debehe/article/details/5053759">网页通过External接口与WebBrowser交互</a>，文中的交互其实只介绍了JS调用C++的部分，而C++调用JS由于微软自己的例子太多，那篇文章就没介绍，不过我最近遇到了一个新问题，和C++调用JS有关，所以重新梳理了下这块的逻辑，把之前的代码完善了下。</p>
<h2 id="我遇到的问题："><a href="#我遇到的问题：" class="headerlink" title="我遇到的问题："></a>我遇到的问题：</h2><p>内嵌IE浏览器控件WebBrowser的内嵌页host.html中使用iframe又嵌套了一个页面iframe.html，iframe.html上有个JS方法，我用C++调用不到，而host.html上的JS方法可以正常调用到。</p>
<h2 id="问题分析："><a href="#问题分析：" class="headerlink" title="问题分析："></a>问题分析：</h2><p>从JS来说，这是个跨域问题，host.html和iframe.html不在一个域内；<br>JS解决跨域问题的方案其实也是有的，但这个不是我们本文的重点，本文的重点是怎么通过WebBrowser控件直接来解决这个“跨域调用”的问题。</p>
<h3 id="问题的根本原因在于："><a href="#问题的根本原因在于：" class="headerlink" title="问题的根本原因在于："></a>问题的根本原因在于：</h3><p>调用网页的JS需要拿到IHTMLDocument2接口，而每个iframe都有自己对应的IHTMLDocument2，所以我们只要能拿到iframe对应的IHTMLDocument2就能解决问题了。</p>
<h2 id="解决方案：直接上代码吧"><a href="#解决方案：直接上代码吧" class="headerlink" title="解决方案：直接上代码吧"></a>解决方案：直接上代码吧</h2><pre><code>/* -------------------------------------------------------------------------
//	FileName	:	calljs_helper.h
//	Creator		:	linyehui
//	Date		:	2013/11/16 01:18:09
//	Brief		:	调用WebBrowser控件内嵌页上的JS函数，iframe中的也能调到
//
//	$Id: $
// -----------------------------------------------------------------------*/
#ifndef __CALLJS_HELPER_H__
#define __CALLJS_HELPER_H__

// -------------------------------------------------------------------------
namespace calljs_helper
&#123;
    bool CallFunction(
        CComPtr&lt;IWebBrowser2&gt; spIWebBrowser, 
        LPCTSTR lpFuncName,
        const vector&lt;wstring&gt;&amp; paramArray, 
        CComVariant * pVarResult = NULL,
        bool bEnumFrame = true);

&#125; // namespace

// -------------------------------------------------------------------------
// $Log: $

#endif /* __CALLJS_HELPER_H__ */



/* -------------------------------------------------------------------------
//	FileName	:	calljs_helper.cpp
//	Creator		:	linyehui
//	Date		:	2013/11/16 01:18:14
//	Brief		:	调用WebBrowser控件内嵌页上的JS函数，iframe中的也能调到
//
//	$Id: $
// -----------------------------------------------------------------------*/

#include &quot;stdafx.h&quot;
#include &quot;calljs_helper.h&quot;

// -------------------------------------------------------------------------

CComPtr&lt;IWebBrowser2&gt; HtmlWindowToHtmlWebBrowser(CComPtr&lt;IHTMLWindow2&gt; spWindow)
&#123;
    ATLASSERT(spWindow != NULL);
    CComQIPtr&lt;IServiceProvider&gt;  spServiceProvider = spWindow;
    if (spServiceProvider == NULL)
    &#123;
        return CComPtr&lt;IWebBrowser2&gt;();
    &#125;

    CComPtr&lt;IWebBrowser2&gt; spWebBrws;
    HRESULT hRes = spServiceProvider-&gt;QueryService(IID_IWebBrowserApp, IID_IWebBrowser2, (void**)&amp;spWebBrws);
    if (hRes != S_OK)
    &#123;
        return CComPtr&lt;IWebBrowser2&gt;();
    &#125;

    return spWebBrws;
&#125;

// Converts a IHTMLWindow2 object to a IHTMLDocument2. Returns NULL in case of failure.
// It takes into account accessing the DOM across frames loaded from different domains.
CComPtr&lt;IHTMLDocument2&gt; HtmlWindowToHtmlDocument(CComPtr&lt;IHTMLWindow2&gt; spWindow)
&#123;
    ATLASSERT(spWindow != NULL);
    CComPtr&lt;IHTMLDocument2&gt; spDocument;
    HRESULT hRes = spWindow-&gt;get_document(&amp;spDocument);
    if ((S_OK == hRes) &amp;&amp; (spDocument != NULL))
    &#123;
        // The html document was properly retrieved.
        return spDocument;
    &#125;

    // hRes could be E_ACCESSDENIED that means a security restriction that
    // prevents scripting across frames that loads documents from different internet domains.
    CComPtr&lt;IWebBrowser2&gt; spBrws = HtmlWindowToHtmlWebBrowser(spWindow);
    if (spBrws == NULL)
    &#123;
        return CComPtr&lt;IHTMLDocument2&gt;();
    &#125;

    // Get the document object from the IWebBrowser2 object.
    CComPtr&lt;IDispatch&gt; spDisp;
    hRes = spBrws-&gt;get_Document(&amp;spDisp);
    spDocument = spDisp;
    return spDocument;
&#125;

bool CallFunctionInDocument(
                            CComPtr&lt;IHTMLDocument2&gt; spDocument2, 
                            LPCTSTR lpFuncName,
                            const vector&lt;wstring&gt;&amp; paramArray, 
                            CComVariant * pVarResult)
&#123;
    if (!spDocument2)
        return false;

    CComPtr&lt;IDispatch&gt; spScript; 
    if (FAILED(spDocument2-&gt;get_Script(&amp;spScript))) &#123; return false; &#125;

    CComBSTR bstrMember(lpFuncName); 
    DISPID dispid = NULL; 
    HRESULT hr = spScript-&gt;GetIDsOfNames(IID_NULL, &amp;bstrMember, 1, LOCALE_SYSTEM_DEFAULT, &amp;dispid); 
    if (FAILED(hr)) &#123; return false; &#125;

    const int arraySize = paramArray.size(); 

    DISPPARAMS dispparams; 
    memset(&amp;dispparams, 0, sizeof dispparams); 
    dispparams.cArgs = arraySize; 
    dispparams.rgvarg = new VARIANT[dispparams.cArgs]; 

    for (int i = 0; i &lt; arraySize; i++)
    &#123;
        CComBSTR bstr = paramArray[arraySize - 1 - i].c_str(); // back reading
        bstr.CopyTo(&amp;dispparams.rgvarg[i].bstrVal); 
        dispparams.rgvarg[i].vt = VT_BSTR; 
    &#125;
    dispparams.cNamedArgs = 0; 

    EXCEPINFO excepInfo; 
    memset(&amp;excepInfo, 0, sizeof excepInfo); 
    CComVariant vaResult; 
    UINT nArgErr = (UINT)-1;  // initialize to invalid arg

    hr = spScript-&gt;Invoke(dispid, IID_NULL, 0, DISPATCH_METHOD, &amp;dispparams, &amp;vaResult, &amp;excepInfo, &amp;nArgErr); 

    delete [] dispparams.rgvarg; 
    if (FAILED(hr)) &#123; return false; &#125;

    if (pVarResult) &#123; *pVarResult = vaResult; &#125;

    return true;
&#125;

void EnumFrame(
                              CComPtr&lt;IHTMLDocument2&gt; spIHTMLDocument2, 
                              LPCTSTR lpFuncName,const vector&lt;wstring&gt;&amp; paramArray, 
                              CComVariant* pVarResult)
&#123;
    if ( !spIHTMLDocument2 )
        return;

    CComPtr&lt; IHTMLFramesCollection2 &gt; spFramesCollection2;
    spIHTMLDocument2-&gt;get_frames( &amp;spFramesCollection2 );

    long nFrameCount=0;
    HRESULT hr = spFramesCollection2-&gt;get_length( &amp;nFrameCount );
    if ( FAILED ( hr ) || 0 == nFrameCount )
        return;

    for(long i = 0; i &lt; nFrameCount; i++)
    &#123;
        CComVariant vDispWin2;
        hr = spFramesCollection2-&gt;item( &amp;CComVariant(i), &amp;vDispWin2 );
        if ( FAILED ( hr ) ) 
            continue;

        CComQIPtr&lt; IHTMLWindow2 &gt; spWin2 = vDispWin2.pdispVal;
        if( !spWin2 )
            continue;

        CComPtr &lt; IHTMLDocument2 &gt; spDoc2;
        spDoc2 = HtmlWindowToHtmlDocument(spWin2);
        if (!spDoc2)
            continue;

        CallFunctionInDocument(spDoc2, lpFuncName, paramArray, pVarResult);
    &#125;
&#125;

bool calljs_helper::CallFunction(
                  CComPtr&lt;IWebBrowser2&gt; spIWebBrowser, 
                  LPCTSTR lpFuncName,
                  const vector&lt;wstring&gt;&amp; paramArray, 
                  CComVariant * pVarResult,
                  bool bEnumFrame)
&#123;
    if (!spIWebBrowser) 
        return false;

    CComPtr&lt;IDispatch&gt; spDispDoc; 
    HRESULT hr = spIWebBrowser-&gt;get_Document(&amp;spDispDoc); 
    if (FAILED(hr))
        return false;

    CComQIPtr&lt;IHTMLDocument2&gt; spDocument2 = spDispDoc; 
    if (!spDocument2)
        return false;

    CallFunctionInDocument(spDocument2, lpFuncName, paramArray, pVarResult);
    
    if (bEnumFrame)
    &#123;
        EnumFrame(spDocument2, lpFuncName, paramArray, pVarResult);
    &#125;
    
    return true; 
&#125;

// -------------------------------------------------------------------------
// $Log: $
</code></pre>
<p>完整的例子代码在附件中。</p>
<h3 id="另外再附上帮助我解决问题的参考资料"><a href="#另外再附上帮助我解决问题的参考资料" class="headerlink" title="另外再附上帮助我解决问题的参考资料:"></a>另外再附上帮助我解决问题的参考资料:</h3><p><a target="_blank" rel="noopener" href="http://blog.csdn.net/skyremember/article/details/3422841">IHTMLWindow2的get_document方法有时候会返回E_ACCESSDENIED</a>  </p>
<p><a target="_blank" rel="noopener" href="http://blog.csdn.net/nvidiacuda/article/details/9300869">VC++实现浏览器自动填表</a>  </p>
<p><a target="_blank" rel="noopener" href="http://www.itdelphi.com/delphibbs/doc/2007/3845499.htm">webbrowser控件的IHTMLDocument3 or2接口的iframe问题（非安全设置）</a>  </p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/rainman/archive/2011/02/21/1960044.html">window.name实现的跨域数据传输</a>  </p>
<p><a target="_blank" rel="noopener" href="http://www.cnblogs.com/rainman/archive/2011/02/20/1959325.html">JavaScript跨域总结与解决办法</a>  </p>
<p>The End.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2012/2012-06-20-music-fm-vs/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2012/2012-06-20-music-fm-vs/" class="post-title-link" itemprop="url">音乐电台对比</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>对于音乐我是个门外汉，本文讨论重点在于音乐电台这类互联网应用的产品体验。  </p>
<p>一直用着豆瓣电台，最近开始体验jing.fm感觉眼前一亮，所以觉得有必要写点东西推一推新产品的新思维，希望QQ音乐电台能更给力点，这样也就不枉费我的QQ绿钻了 :)</p>
<h1 id="douban-fm"><a href="#douban-fm" class="headerlink" title="douban.fm"></a>douban.fm</h1><p>我最开始用的音乐电台，很省心的产品，但是在我听过的歌曲达到了2W之后我开始稍微有点反感了：  </p>
<ol>
<li>大部分的音乐都是演唱会的歌曲，质量很低（也许是版权费的问题，专挑免费的歌曲，歌手总要出来说说话，类似“杰伦加油”这种，当然这个我还是可以接受的，无法接受的是唱完歌还要说几分钟话的那种）</li>
<li>推荐的歌曲已经开始变成一个大循环了，歌越听越少</li>
<li>“发现DJ”的出发点很好，用户创造内容是未来发展的大方向，但是目前来看高质量的DJ还是太少，而且不一定符合自己的心情，寻找合适自己的DJ电台比较麻烦</li>
<li>不能屏蔽艺人（某些道德沦陷的艺人，我一点都不想听到，和歌曲无关）</li>
</ol>
<h1 id="fm-qq-com-y-qq-com"><a href="#fm-qq-com-y-qq-com" class="headerlink" title="fm.qq.com + y.qq.com"></a>fm.qq.com + y.qq.com</h1><ol>
<li>和豆瓣音乐和豆瓣电台比唯一的优势是正版音乐比较多，音乐质量稍微高点</li>
<li>有y.qq.com做支持，不担心版权的问题，歌曲比较全，艺人电台比较全</li>
<li>猜你喜欢的算法对于我来说还太弱了，总是没能找准我喜欢的音乐，这点不如豆瓣电台（这点不同人理解不同，我也见过说好的）</li>
<li>有歌词，不过听电台很少看这个，偶尔会看下</li>
<li>不能屏蔽艺人（某些道德沦陷的艺人，我一点都不想听到，和歌曲无关）</li>
</ol>
<h1 id="jing-fm"><a href="#jing-fm" class="headerlink" title="jing.fm"></a>jing.fm</h1><ol>
<li>jing.fm是最近刚出来的一款音乐电台应用，他的Genius功能可以说是惊艳！艺压群芳！（可以根据你的情感. 风格. 艺人来进行快速的搜索听歌）</li>
<li>同时具备个人电台. 喜欢、删除，还有刚刚推出的屏蔽艺人的功能（赞！）</li>
<li>可以说是在众多音乐电台吵来吵去的时候出现的一次大变革，大突破。</li>
<li>jing.fm 的音乐关键字竟然有“雨声”！其他的音乐电台瞬时被秒杀</li>
<li>HTML5播放器下经常听歌听到一半卡住，换成flash播放器后就比较少出现，不过产品刚出来不久，后面应该会改善（记得豆瓣电台刚开始也有类似的问题，我还在twitter反馈过，现在偶尔也会这样）</li>
</ol>
<p>xiami.com&#x2F;radio和meile.com&#x2F;fm 我个人用的很少，只是简单体验过，没有太多新意。</p>
<h1 id="小结："><a href="#小结：" class="headerlink" title="小结："></a>小结：</h1><ol>
<li>老牌劲旅豆瓣电台如果不收费的话必然受限于版权问题，歌曲越听越少</li>
<li>QQ音乐电台依靠QQ音乐强大的音乐版权，艺人电台是最大优势，猜你喜欢还有很大的提升空间</li>
<li>jing.fm 刚刚推出，不仅界面交互让人眼前一亮，Genius的音乐搜索功能绝对算的上是一次变革，很让人期待</li>
</ol>
<p>怎么写得有点像软文，我觉得最快把Genius COPY过去的会是QQ音乐，豆瓣电台会在“发现DJ”这块继续发力，用户创造内容是大方向，但是搜索要优化。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2012/2012-07-11-taiwan-2012/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2012/2012-07-11-taiwan-2012/" class="post-title-link" itemprop="url">台湾</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>作为一个中国人，台湾是那样的熟悉，却又是那样的陌生；没有人不知道台湾，但也没几个人能说的清楚台湾。  </p>
<p>在刚刚过去的6天5夜，我有幸和同事们一起和台湾来了个亲密接触。  </p>
<p>6天5夜的台湾之行根本不够我们认真的体验台湾，但却足以感受台湾的热情，台湾最美的不是她的风景，不是购物天堂，不仅仅是台妹销魂的声音，而是台湾的风土人情。</p>
<h1 id="台妹的声音"><a href="#台妹的声音" class="headerlink" title="台妹的声音"></a>台妹的声音</h1><p>大陆媒体上能听得到的好多台湾女孩的声音都很做作，听到鸡皮疙瘩都快起来了，但我们在台北听到了声音是自然的、舒服的、骨头都会酥掉的</p>
<h1 id="汽车"><a href="#汽车" class="headerlink" title="汽车"></a>汽车</h1><p>汽油、的士没有垄断！我们只打过一次的，在车上和司机简单的聊了会，发现：  </p>
<ul>
<li>1.没有燃油附加费（台湾的油价对市场的反应很快，升得快，降得也快）；</li>
<li>2.不用交份子钱，车归自己，包括税在内一个月交2000块新台币左右后其他的都算自己的（我们去的那几天1元钱人民币可以换4.6元新台币）；</li>
<li>3.只要你有驾照交1万新台币就能拿到的士拍照</li>
<li>4.马路上几乎有8成以上是日本车（丰田、三菱、日产……），然后是宝马，奔驰，在夜市见过一辆兰博基尼</li>
<li>5.我们回来的那天台湾98#的油价小涨了点，是新台币35.3，约合人民币7.6，这个时候深圳的97#是￥8.6</li>
</ul>
<h1 id="购物点"><a href="#购物点" class="headerlink" title="购物点"></a>购物点</h1><p>相对来说没有大陆的那些购物点那么让人反感，没有表现出那么势利好像</p>
<h1 id="阿德哥"><a href="#阿德哥" class="headerlink" title="阿德哥"></a>阿德哥</h1><p>我们的台湾地陪阿德哥，是一个很黄但又有点淳朴的大叔，他总是说：“好啦，我给你们讲个黄色笑话”。  </p>
<p>去完阿里山的那个晚上，我们还有一个景点没去，但是大家都很累了，所以一致统一不去那个景点了，但大陆旅行社的领队就说必须写下这个情况，所有人签字才可以。阿德哥写完后给大陆领队看，领队说不行不行，怎么能写：“由于天色已晚，考虑到安全问题，大家一致同意……”，要写“由于天色已晚，所有团员主动要求……”</p>
<h1 id="景点"><a href="#景点" class="headerlink" title="景点"></a>景点</h1><p>景点不会让你震撼，但都挺舒服的  </p>
<p>由于我一贯主张出来旅游不能累着自己，所以好几个地方如果我觉得可去可不去的话我就不去了，比如野柳地质公园，我就是走了一半我就回去找了个凉快的地方等他们；这样的整个行程下来走的最累的应该是故宫博物院。</p>
<h1 id="城市"><a href="#城市" class="headerlink" title="城市"></a>城市</h1><p>我最喜欢的是台中，惬意的有点像珠海;台北人太多，像香港;高雄是重工业城市，弥漫着浓厚的油烟味。</p>
<h1 id="期待什么时候可以台湾自助游"><a href="#期待什么时候可以台湾自助游" class="headerlink" title="期待什么时候可以台湾自助游~"></a>期待什么时候可以台湾自助游~</h1>
      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2012/2012-07-19-tips-of-winrt-component-in-cpp-and-calling-it-from-js/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2012/2012-07-19-tips-of-winrt-component-in-cpp-and-calling-it-from-js/" class="post-title-link" itemprop="url">WinRT下JavaScript调用C++ WinRT组件的注意事项</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>有段时间没有写WinRT相关的文章了，这段时间还会继续，因为我们目前在进行界面应用层的HTML5化 :)</p>
<h1 id="今天要和大家分享的是："><a href="#今天要和大家分享的是：" class="headerlink" title="今天要和大家分享的是："></a>今天要和大家分享的是：</h1><p>WinRT下，使用HTML+JavaScript实现的界面应用层，调用C++实现的底层WinRT组件（Windows Runtime component）的相关注意事项</p>
<h1 id="嗯，标题很长，下面我们来干货："><a href="#嗯，标题很长，下面我们来干货：" class="headerlink" title="嗯，标题很长，下面我们来干货："></a>嗯，标题很长，下面我们来干货：</h1><ul>
<li><p>0、提供给JS工程调用的C++类必须是ref类，这个好像不用说吧？:)</p>
</li>
<li><p>1、JS调用的函数名首字母必须是小写，无论你C++代码实际是不是小写，比如：KillBill()，在JS中调用的时候必须写成killBill()</p>
</li>
<li><p>2、JS调用的delegate方法，在赋值时要注意加上前缀”on”，同时全部字母小写，比如：C++类中有这么一个成员变量：</p>
<blockquote>
<p>event OOXXEventDelegate^ OOXXEvent，<br>那么你在JS中给他赋值时必须这么写：<br>objOOXX.onooxxevent &#x3D; handler_ooxx;</p>
</blockquote>
</li>
<li><p>3、提供给JS工程调用的C++类的命名空间必须和DLL的名字相同，比如你的DLL叫做SuperEngine，那么你的类的顶级命名空间也必须是SuperEngine</p>
</li>
<li><p>4、JS可以调用ref 类的静态方法，但是记得方法名一样要首字母小写</p>
</li>
<li><p>5、回调回JS的代码必须在主界面线程中回调，否则会失败，这个在XAML下也是一样的，解决的方法还是比较简单的，就是在一开始保存下当前的Dispatcher，</p>
<blockquote>
<p>auto dispatcher &#x3D; Windows::ApplicationModel::Core::CoreApplication::GetCurrentView()-&gt;CoreWindow-&gt;Dispatcher;<br>然后回调的地方用RunAsync跳转下：<br>auto callback &#x3D; ref new Windows::UI::Core::DispatchedHandler(<a href="">&#x3D;</a>{<br>m_event-&gt;OOXXEvent(eCode, ref new Platform::String(strErrTip.pstr));<br>});<br>m_dispatcher-&gt;RunAsync(Windows::UI::Core::CoreDispatcherPriority::Normal, callback);</p>
</blockquote>
</li>
<li><p>6、导出的类必须要有CPP文件JS那边才能访问的到</p>
</li>
<li><p>7、导出的类所继承的类不可以包含数据成员变量和Event类型的成员变量，private的也不行</p>
</li>
<li><p>8、导出的类可以继承接口，接口中可以包含event类型的变量(理论上其实event就是个函数），这条和上一条并不冲突。<br>举个例子说明下这两点：</p>
<ul>
<li>8.1、你有一个接口INotifyPropertyChanged，接口只有一个方法：event PropertyChangedEventHandler^ PropertyChanged;</li>
<li>8.2、如果：你的实现类直接继承了INotifyPropertyChanged，那么这样的导出类是没有问题的（这个时候按照语法你需要在你的实现类中这样声明下：</li>
</ul>
<p>   virtual event PropertyChangedEventHandler^ PropertyChanged;</p>
<ul>
<li>8.3、如果：你的实现类，继承了一个类叫做NotifyPropertyChangedBase，而NotifyPropertyChangedBase又继承了INotifyPropertyChanged，那么这个代码在C++这边编译没有问题，但是JS一调用就会crash：</li>
</ul>
<p>  An unhandled win32 exception occurred in WWAHost.exe</p>
</li>
<li><p>9、还有什么回头想到我再补上</p>
</li>
</ul>
<h1 id="微软官方提供的例子其实还是挺不错的，只是说的没那么清楚："><a href="#微软官方提供的例子其实还是挺不错的，只是说的没那么清楚：" class="headerlink" title="微软官方提供的例子其实还是挺不错的，只是说的没那么清楚："></a>微软官方提供的例子其实还是挺不错的，只是说的没那么清楚：</h1><p>[<a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/windows/apps/hh755833(v=vs.110).aspx">http://msdn.microsoft.com/en-us/library/windows/apps/hh755833(v=vs.110).aspx</a> MSDN：Walkthrough: Creating a basic Windows Runtime component in C++ and calling it from JavaScript]</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2012/2012-08-25-tips-for-using-currentapp-in-an-metro-style-app/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2012/2012-08-25-tips-for-using-currentapp-in-an-metro-style-app/" class="post-title-link" itemprop="url">Windows 8下如何使用Windows.ApplicationModel.Store的CurrentApp类</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="首先你应该知道这个类大概是做什么的："><a href="#首先你应该知道这个类大概是做什么的：" class="headerlink" title="首先你应该知道这个类大概是做什么的："></a>首先你应该知道这个类大概是做什么的：</h1><p>Windows::ApplicationModel::Store::CurrentApp  </p>
<p><a target="_blank" rel="noopener" href="http://msdn.microsoft.com/en-us/library/windows/apps/br229885.aspx">MSDN上的说明：Windows.ApplicationModel.Store classes</a></p>
<p>上面的MSDN页面给我们提供的API主要是用于Metro Style  App的Store购买相关的信息和功能，其实微软给我们提供了两个类：  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CurrentApp class</span><br><span class="line">Defines methods and properties you can use to get license and listing info about the current app and perform in-app purchases.</span><br><span class="line"></span><br><span class="line">CurrentAppSimulator class</span><br><span class="line">Defines methods and properties used to instantiate an object that you can use to get simulated license info during testing.</span><br></pre></td></tr></table></figure>

<p>这两个类中，微软推荐我们用CurrentAppSimulator进行测试，可惜我有个坏毛病，代码一定要自己跑过一次才相信，微软所说的先用CurrentAppSimulator调试，上架的时候直接换成CurrentApp就万事大吉了，这样的“理所当然”我可不信，所以我想方设法想亲自验证下CurrentApp这个类的功能，下面是一些我自己的验证。</p>
<h1 id="测试环境："><a href="#测试环境：" class="headerlink" title="测试环境："></a>测试环境：</h1><p>外网大家正在用的Windows 8 RTM版本，VS2012（这俩微软官没有正式版，所以本文的结论一段时间后可能会被微软自己推翻）</p>
<h1 id="我遇到的问题："><a href="#我遇到的问题：" class="headerlink" title="我遇到的问题："></a>我遇到的问题：</h1><p>微软的MSDN说要调试CurrentApp必须使用开发者帐号，且应用已经上架，那我就想我本地想调试应该怎么弄呢？我不想用CurrentAppSimulator敷衍我自己  </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">2012/9/8 补充</span><br><span class="line">这里其实有猫腻，所谓的已经上架还不够，还需要你在调试的机器上购买并下载了这个应用才算数</span><br><span class="line">所以调试之前一定要到应用商店的“你的应用”中检查下要调试的应用的状态</span><br></pre></td></tr></table></figure>
<h2 id="最后成功的方案和需要注意的细节："><a href="#最后成功的方案和需要注意的细节：" class="headerlink" title="最后成功的方案和需要注意的细节："></a>最后成功的方案和需要注意的细节：</h2><ul>
<li>1、应用已经上架，这个是必须的，如果没有的话就确实只能用CurrentAppSimulator</li>
<li>2、Package.appxmanifest里Packageing Tab页的Publisher属性必须是你已经上架了的应用的开发者帐号对应的证书，这个证书在你创建用于上传到Store的Package时会自动帮你填充（<strong>这个证书是关键</strong>）</li>
<li>3、只要你调试的时候符合上面两个条件，无论你是本机直接F5调试还是编译本地安装包然后测试，都能获取到CurrentApp的Store信息。你会发现异步获取到的ListingInformation就是你在Store后台配置的应用信息。(ListingInformation-&gt;Name就是Store上的应用名)</li>
</ul>
<h2 id="修改安装后的应用文件是否会影响CurrentApp-gt-LicenseInformation的IsActive和IsTrial呢？"><a href="#修改安装后的应用文件是否会影响CurrentApp-gt-LicenseInformation的IsActive和IsTrial呢？" class="headerlink" title="修改安装后的应用文件是否会影响CurrentApp-&gt;LicenseInformation的IsActive和IsTrial呢？"></a>修改安装后的应用文件是否会影响CurrentApp-&gt;LicenseInformation的IsActive和IsTrial呢？</h2><p>我的实验结果是不会，而且我发现这影响Store返回的两个属性值的关键在于我上面提到的Package.appxmanifest里Packageing Tab页的Publisher这个证书。  </p>
<p>也就是说你从Store安装了某个应用，然后修改这个应用安装目录下的文件，CurrentApp-&gt;LicenseInformation的IsActive和IsTrial属性并不会受到影响，其他的属性我就没有进一步确认，大家有兴趣可以自己验证。</p>
<h2 id="2012-x2F-9-x2F-8-21-18-今晚调试后再补充点信息吧，希望对读者有用："><a href="#2012-x2F-9-x2F-8-21-18-今晚调试后再补充点信息吧，希望对读者有用：" class="headerlink" title="2012&#x2F;9&#x2F;8 21:18 今晚调试后再补充点信息吧，希望对读者有用："></a>2012&#x2F;9&#x2F;8 21:18 今晚调试后再补充点信息吧，希望对读者有用：</h2><ul>
<li>1、没有网络的时候获取License Information是会失败的</li>
<li>2、没有购买的时候获取License Information也是会失败的</li>
<li>3、License获取的线程也是有讲究的，你用线程定时器起来的异步操作中执行的话，需要先做下线程切换</li>
</ul>
<p>所以我们需要对代码进行异常捕获，要这么写才可以： </p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">void</span> <span class="title">AppEngine::InitializeLicenseCore</span><span class="params">()</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">	<span class="keyword">try</span></span><br><span class="line">	&#123;</span><br><span class="line">		m_licenseInformation = CurrentApp::LicenseInformation;</span><br><span class="line">		<span class="function">task&lt;ListingInformation^&gt; <span class="title">listingTask</span><span class="params">(CurrentApp::LoadListingInformationAsync())</span></span>;</span><br><span class="line">		<span class="keyword">this</span>-&gt;m_licenseInformation-&gt;LicenseChanged += ref <span class="keyword">new</span> <span class="built_in">LicenseChangedEventHandler</span>(<span class="keyword">this</span>, &amp;AppEngine::OnLicenseChanged);</span><br><span class="line">		<span class="keyword">this</span>-&gt;<span class="built_in">OnLicenseChanged</span>();</span><br><span class="line"></span><br><span class="line">		listingTask.<span class="built_in">then</span>([=](ListingInformation^ listing)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">this</span>-&gt;m_listingInformation = listing;</span><br><span class="line">			Platform::String^ name = <span class="keyword">this</span>-&gt;m_listingInformation-&gt;Name;</span><br><span class="line">			<span class="comment">// ...</span></span><br><span class="line">		&#125;)</span><br><span class="line">		.<span class="built_in">then</span>([=](Concurrency::task&lt;<span class="type">void</span>&gt; t)</span><br><span class="line">		&#123;</span><br><span class="line">			<span class="keyword">try</span></span><br><span class="line">			&#123;</span><br><span class="line">				t.<span class="built_in">get</span>();</span><br><span class="line">			&#125;</span><br><span class="line">			<span class="built_in">catch</span> (Platform::Exception ^ e)</span><br><span class="line">			&#123;</span><br><span class="line">				<span class="built_in">log_error</span>(<span class="string">&quot;license listing task exception&quot;</span>);</span><br><span class="line">			&#125;</span><br><span class="line">		&#125;);</span><br><span class="line">	&#125;</span><br><span class="line">	<span class="built_in">catch</span> (Platform::Exception^ e)</span><br><span class="line">	&#123;</span><br><span class="line">		<span class="built_in">log_error</span>(<span class="string">&quot;InitializeLicenseCore exception&quot;</span>);</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>Windows 8还没正式发布，我所说的都是错的 :)</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://linyehui.me/2022/05/17/2012/2012-09-20-remote-debug-using-vs2012/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="linyehui">
      <meta itemprop="description" content="HABIT IS POWER">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="HABIT IS POWER">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/05/17/2012/2012-09-20-remote-debug-using-vs2012/" class="post-title-link" itemprop="url">用VS2012远程调试Metro style apps</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-05-17 15:49:14" itemprop="dateCreated datePublished" datetime="2022-05-17T15:49:14+08:00">2022-05-17</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="我的问题："><a href="#我的问题：" class="headerlink" title="我的问题："></a>我的问题：</h1><p>环境：  </p>
<p>Windows 8 版本 RTM (Build9200) + Visual Studio Ultimate 2012(Version 11.0.50722.1)</p>
<p>我希望在同一个无线网络下的PC和平板之间远程调试我们的Metro 应用，PC上安装了VS2012，平板上没有安装VS2012，但是遇到了些问题</p>
<h1 id="解决方案："><a href="#解决方案：" class="headerlink" title="解决方案："></a>解决方案：</h1><ul>
<li><p>1、在平板上安装远程调试工具包：rtools_setup_x64.exe</p>
</li>
<li><p>2、在平板上运行并配置Remote Debugger</p>
<ul>
<li>2.1 记得以管理员权限打开Remote Debugging Monitor</li>
<li>2.2 配置认证方法，使用“No Authenticaton”并勾选”Allow any user to debug”</li>
</ul>
</li>
<li><p>3、在PC上，打开VS，菜单”Tools”-&gt;”Attach to Process”，选择Remote，然后输入平板的IP地址，随便选择一个进程进行attach**</p>
</li>
<li><p>4、必须要有第三步，因为我发现我从PC竟然ping不到平板的IP，但是却可以用第三步attach到平板上的进程</p>
</li>
<li><p>5、取消第三步的attach，打开你需要远程调试的工程，Debug Target选择“Remote Machine”，然后F5</p>
</li>
<li><p>6、搞定</p>
</li>
</ul>
<p>关键在于远程之前先attach下，应该是VS的一个Bug，不知道新版本是否解决了，这里备忘下</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/8/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/8/">8</a><span class="page-number current">9</span><a class="page-number" href="/page/10/">10</a><span class="space">&hellip;</span><a class="page-number" href="/page/15/">15</a><a class="extend next" rel="next" href="/page/10/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">linyehui</p>
  <div class="site-description" itemprop="description">HABIT IS POWER</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">143</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
        <span class="site-state-item-count">178</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">linyehui</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
